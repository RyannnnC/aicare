{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"F:\\\\Github\\\\aicare\\\\node_modules\\\\react-native-calendar-picker\\\\CalendarPicker\\\\Scroller.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport PropTypes from 'prop-types';\nimport { RecyclerListView, DataProvider, LayoutProvider } from 'recyclerlistview';\nimport moment from 'moment';\n\nvar CalendarScroller = function (_Component) {\n  _inherits(CalendarScroller, _Component);\n\n  var _super = _createSuper(CalendarScroller);\n\n  function CalendarScroller(props) {\n    var _this;\n\n    _classCallCheck(this, CalendarScroller);\n\n    _this = _super.call(this, props);\n\n    _this.scrollLeft = function () {\n      var _this$state = _this.state,\n          currentIndex = _this$state.currentIndex,\n          numVisibleItems = _this$state.numVisibleItems;\n\n      if (currentIndex === 0) {\n        return;\n      }\n\n      var newIndex = Math.max(currentIndex - numVisibleItems, 0);\n      _this.rlv && _this.rlv.scrollToIndex(newIndex, true);\n    };\n\n    _this.scrollRight = function () {\n      var _this$state2 = _this.state,\n          currentIndex = _this$state2.currentIndex,\n          numVisibleItems = _this$state2.numVisibleItems,\n          numMonths = _this$state2.numMonths;\n      var newIndex = Math.min(currentIndex + numVisibleItems, numMonths - 1);\n      _this.rlv && _this.rlv.scrollToIndex(newIndex, true);\n    };\n\n    _this.shiftMonthsForward = function (currentMonth) {\n      _this.shiftMonths(currentMonth, _this.state.numMonths / 3);\n    };\n\n    _this.shiftMonthsBackward = function (currentMonth) {\n      _this.shiftMonths(currentMonth, _this.state.numMonths * 2 / 3);\n    };\n\n    _this.goToMonthYear = function (_ref) {\n      var month = _ref.month,\n          year = _ref.year;\n      var _this$state3 = _this.state,\n          data = _this$state3.data,\n          numMonths = _this$state3.numMonths;\n      var monthYear = moment({\n        month: month,\n        year: year,\n        hour: 12\n      });\n\n      for (var i = 0; i < numMonths; i++) {\n        if (data[i].isSame(monthYear, 'month')) {\n          _this.rlv && _this.rlv.scrollToIndex(i, false);\n          return;\n        }\n      }\n\n      _this.shiftMonths(monthYear, numMonths / 2);\n    };\n\n    _this.shiftMonths = function (currentMonth, offset) {\n      var prevVisMonth = currentMonth.clone();\n      var newStartMonth = prevVisMonth.clone().subtract(Math.floor(offset), 'months');\n\n      _this.updateMonths(prevVisMonth, newStartMonth);\n    };\n\n    _this.updateMonths = function (prevVisMonth, newStartMonth) {\n      if (_this.shifting) {\n        return;\n      }\n\n      var _this$props = _this.props,\n          minDate = _this$props.minDate,\n          maxDate = _this$props.maxDate,\n          restrictMonthNavigation = _this$props.restrictMonthNavigation;\n      var data = [];\n      var _newStartMonth = newStartMonth;\n\n      if (minDate && restrictMonthNavigation && newStartMonth.isBefore(minDate, 'month')) {\n        _newStartMonth = moment(minDate);\n      }\n\n      for (var i = 0; i < _this.state.numMonths; i++) {\n        var date = _newStartMonth.clone().add(i, 'months');\n\n        if (maxDate && restrictMonthNavigation && date.isAfter(maxDate, 'month')) {\n          break;\n        }\n\n        data.push(date);\n      }\n\n      if (data.length < _this.props.maxSimultaneousMonths) {\n        return;\n      }\n\n      var _loop = function _loop(_i) {\n        if (data[_i].isSame(prevVisMonth, 'month')) {\n          _this.shifting = true;\n          _this.rlv && _this.rlv.scrollToIndex(_i, false);\n          setTimeout(function () {\n            _this.rlv && _this.rlv.scrollToIndex(_i, false);\n            _this.shifting = false;\n          }, 800);\n          return \"break\";\n        }\n      };\n\n      for (var _i = 0; _i < data.length; _i++) {\n        var _ret = _loop(_i);\n\n        if (_ret === \"break\") break;\n      }\n\n      _this.setState({\n        data: data,\n        dataProvider: _this.dataProvider.cloneWithRows(data)\n      });\n    };\n\n    _this.onVisibleIndicesChanged = function (all, now) {\n      var _this$state4 = _this.state,\n          data = _this$state4.data,\n          numMonths = _this$state4.numMonths,\n          _currentMonth = _this$state4.currentMonth;\n      var _this$props2 = _this.props,\n          updateMonthYear = _this$props2.updateMonthYear,\n          onMonthChange = _this$props2.onMonthChange;\n      var currentIndex = now[0] || all[0];\n      var currentMonth = data[currentIndex];\n\n      if (!_currentMonth || !_currentMonth.isSame(currentMonth, 'month')) {\n        var currMonth = currentMonth && currentMonth.clone();\n        onMonthChange && onMonthChange(currMonth);\n      }\n\n      updateMonthYear && updateMonthYear(currentMonth, true);\n\n      if (currentIndex === 0) {\n        _this.shiftMonthsBackward(currentMonth);\n      } else if (currentIndex > numMonths - 3) {\n        _this.shiftMonthsForward(currentMonth);\n      }\n\n      _this.setState({\n        currentMonth: currentMonth,\n        currentIndex: currentIndex\n      });\n    };\n\n    _this.onLayout = function (event) {\n      var containerWidth = event.nativeEvent.layout.width;\n\n      _this.setState(_objectSpread({\n        numVisibleItems: Math.floor(containerWidth / _this.state.itemWidth)\n      }, _this.updateLayout(_this.props.renderMonthParams.styles)));\n    };\n\n    _this.rowRenderer = function (type, rowMonth, i, extState) {\n      var _this$props3 = _this.props,\n          updateMonthYear = _this$props3.updateMonthYear,\n          renderMonth = _this$props3.renderMonth;\n\n      var _updateMonthYear = updateMonthYear(rowMonth),\n          month = _updateMonthYear.currentMonth,\n          year = _updateMonthYear.currentYear;\n\n      return renderMonth && renderMonth(_objectSpread(_objectSpread({}, extState), {}, {\n        month: month,\n        year: year\n      }));\n    };\n\n    _this.updateLayout = function (dims) {\n      var itemWidth = dims.containerWidth;\n      var itemHeight = dims.containerHeight;\n\n      if (dims.dayWrapper && dims.dayWrapper.height) {\n        itemHeight = dims.dayWrapper.height * 6;\n      }\n\n      var layoutProvider = new LayoutProvider(function () {\n        return 0;\n      }, function (type, dim) {\n        dim.width = itemWidth;\n        dim.height = itemHeight;\n      });\n      return {\n        layoutProvider: layoutProvider,\n        itemHeight: itemHeight,\n        itemWidth: itemWidth\n      };\n    };\n\n    _this.dataProvider = new DataProvider(function (r1, r2) {\n      return r1 !== r2;\n    });\n\n    _this.updateMonthsData = function (data) {\n      return {\n        data: data,\n        numMonths: data.length,\n        dataProvider: _this.dataProvider.cloneWithRows(data)\n      };\n    };\n\n    _this.state = _objectSpread(_objectSpread(_objectSpread({}, _this.updateLayout(props.renderMonthParams.styles)), _this.updateMonthsData(props.data)), {}, {\n      numVisibleItems: 1\n    });\n    return _this;\n  }\n\n  _createClass(CalendarScroller, [{\n    key: \"shouldComponentUpdate\",\n    value: function shouldComponentUpdate(prevProps, prevState) {\n      return this.state.data !== prevState.data || this.state.itemHeight !== prevState.itemHeight || this.state.itemWidth !== prevState.itemWidth || this.props.renderMonthParams !== prevProps.renderMonthParams;\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      var newState = {};\n      var updateState = false;\n\n      if (this.props.renderMonthParams.styles !== prevProps.renderMonthParams.styles) {\n        updateState = true;\n        newState = this.updateLayout(this.props.renderMonthParams);\n      }\n\n      if (this.props.data !== prevProps.data) {\n        updateState = true;\n        newState = _objectSpread(_objectSpread({}, newState), this.updateMonthsData(this.props.data));\n      }\n\n      if (updateState) {\n        this.setState(newState);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$state5 = this.state,\n          data = _this$state5.data,\n          numMonths = _this$state5.numMonths,\n          height = _this$state5.itemHeight,\n          width = _this$state5.itemWidth,\n          layoutProvider = _this$state5.layoutProvider,\n          dataProvider = _this$state5.dataProvider;\n\n      if (!data || numMonths === 0 || !height) {\n        return null;\n      }\n\n      return React.createElement(View, {\n        style: {\n          width: width,\n          height: height\n        },\n        onLayout: this.onLayout,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 7\n        }\n      }, React.createElement(RecyclerListView, {\n        ref: function ref(rlv) {\n          return _this2.rlv = rlv;\n        },\n        layoutProvider: layoutProvider,\n        dataProvider: dataProvider,\n        rowRenderer: this.rowRenderer,\n        extendedState: this.props.renderMonthParams,\n        initialRenderIndex: this.props.initialRenderIndex,\n        onVisibleIndicesChanged: this.onVisibleIndicesChanged,\n        isHorizontal: this.props.horizontal,\n        scrollViewProps: {\n          showsHorizontalScrollIndicator: false,\n          snapToInterval: this.props.horizontal ? width : height\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 259,\n          columnNumber: 9\n        }\n      }));\n    }\n  }]);\n\n  return CalendarScroller;\n}(Component);\n\nCalendarScroller.propTypes = {\n  data: PropTypes.array.isRequired,\n  initialRenderIndex: PropTypes.number,\n  renderMonth: PropTypes.func,\n  renderMonthParams: PropTypes.object.isRequired,\n  minDate: PropTypes.any,\n  maxDate: PropTypes.any,\n  maxSimultaneousMonths: PropTypes.number,\n  horizontal: PropTypes.bool,\n  updateMonthYear: PropTypes.func,\n  onMonthChange: PropTypes.func\n};\nCalendarScroller.defaultProps = {\n  data: [],\n  renderMonthParams: {\n    styles: {}\n  }\n};\nexport { CalendarScroller as default };","map":{"version":3,"sources":["F:/Github/aicare/node_modules/react-native-calendar-picker/CalendarPicker/Scroller.js"],"names":["React","Component","PropTypes","RecyclerListView","DataProvider","LayoutProvider","moment","CalendarScroller","props","scrollLeft","state","currentIndex","numVisibleItems","newIndex","Math","max","rlv","scrollToIndex","scrollRight","numMonths","min","shiftMonthsForward","currentMonth","shiftMonths","shiftMonthsBackward","goToMonthYear","month","year","data","monthYear","hour","i","isSame","offset","prevVisMonth","clone","newStartMonth","subtract","floor","updateMonths","shifting","minDate","maxDate","restrictMonthNavigation","_newStartMonth","isBefore","date","add","isAfter","push","length","maxSimultaneousMonths","setTimeout","setState","dataProvider","cloneWithRows","onVisibleIndicesChanged","all","now","_currentMonth","updateMonthYear","onMonthChange","currMonth","onLayout","event","containerWidth","nativeEvent","layout","width","itemWidth","updateLayout","renderMonthParams","styles","rowRenderer","type","rowMonth","extState","renderMonth","currentYear","dims","itemHeight","containerHeight","dayWrapper","height","layoutProvider","dim","r1","r2","updateMonthsData","prevProps","prevState","newState","updateState","initialRenderIndex","horizontal","showsHorizontalScrollIndicator","snapToInterval","propTypes","array","isRequired","number","func","object","any","bool","defaultProps"],"mappings":"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","sourcesContent":["// This is a bi-directional infinite scroller.\r\n// As the beginning & end are reached, the dates are recalculated and the current\r\n// index adjusted to match the previous visible date.\r\n// RecyclerListView helps to efficiently recycle instances, but the data that\r\n// it's fed is finite. Hence the data must be shifted at the ends to appear as\r\n// an infinite scroller.\r\n\r\nimport React, { Component } from 'react';\r\nimport { View } from 'react-native';\r\nimport PropTypes from 'prop-types';\r\nimport { RecyclerListView, DataProvider, LayoutProvider } from 'recyclerlistview';\r\nimport moment from 'moment';\r\n\r\nexport default class CalendarScroller extends Component {\r\n  static propTypes = {\r\n    data: PropTypes.array.isRequired,\r\n    initialRenderIndex: PropTypes.number,\r\n    renderMonth: PropTypes.func,\r\n    renderMonthParams: PropTypes.object.isRequired,\r\n    minDate: PropTypes.any,\r\n    maxDate: PropTypes.any,\r\n    maxSimultaneousMonths: PropTypes.number,\r\n    horizontal: PropTypes.bool,\r\n    updateMonthYear: PropTypes.func,\r\n    onMonthChange: PropTypes.func,\r\n  }\r\n\r\n  static defaultProps = {\r\n    data: [],\r\n    renderMonthParams: { styles: {} },\r\n  };\r\n\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.updateLayout = dims => {\r\n      const itemWidth = dims.containerWidth;\r\n      let itemHeight = dims.containerHeight;\r\n      if (dims.dayWrapper && dims.dayWrapper.height) {\r\n        itemHeight = dims.dayWrapper.height * 6; // max 6 row weeks per month\r\n      }\r\n\r\n      const layoutProvider = new LayoutProvider(\r\n        () => 0, // only 1 view type\r\n        (type, dim) => {\r\n          dim.width = itemWidth;\r\n          dim.height = itemHeight;\r\n        }\r\n      );\r\n\r\n      return { layoutProvider, itemHeight, itemWidth };\r\n    };\r\n\r\n    this.dataProvider = new DataProvider((r1, r2) => {\r\n      return r1 !== r2;\r\n    });\r\n\r\n    this.updateMonthsData = data => {\r\n      return {\r\n        data,\r\n        numMonths: data.length,\r\n        dataProvider: this.dataProvider.cloneWithRows(data),\r\n      };\r\n    };\r\n\r\n    this.state = {\r\n      ...this.updateLayout(props.renderMonthParams.styles),\r\n      ...this.updateMonthsData(props.data),\r\n      numVisibleItems: 1, // updated in onLayout\r\n    };\r\n  }\r\n\r\n  shouldComponentUpdate(prevProps, prevState) {\r\n    return this.state.data !== prevState.data ||\r\n      this.state.itemHeight !== prevState.itemHeight ||\r\n      this.state.itemWidth !== prevState.itemWidth ||\r\n      this.props.renderMonthParams !== prevProps.renderMonthParams;\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    let newState = {};\r\n    let updateState = false;\r\n\r\n    if (this.props.renderMonthParams.styles !== prevProps.renderMonthParams.styles) {\r\n      updateState = true;\r\n      newState = this.updateLayout(this.props.renderMonthParams);\r\n    }\r\n\r\n    if (this.props.data !== prevProps.data) {\r\n      updateState = true;\r\n      newState = {...newState, ...this.updateMonthsData(this.props.data)};\r\n    }\r\n\r\n    if (updateState) {\r\n      this.setState(newState);\r\n    }\r\n  }\r\n\r\n  // Scroll left, guarding against start index.\r\n  scrollLeft = () => {\r\n    const { currentIndex, numVisibleItems } = this.state;\r\n    if (currentIndex === 0) {\r\n      return;\r\n    }\r\n    const newIndex = Math.max(currentIndex - numVisibleItems, 0);\r\n    this.rlv && this.rlv.scrollToIndex(newIndex, true);\r\n  }\r\n\r\n  // Scroll right, guarding against end index.\r\n  scrollRight = () => {\r\n    const { currentIndex, numVisibleItems, numMonths } = this.state;\r\n    const newIndex = Math.min(currentIndex + numVisibleItems, numMonths - 1);\r\n    this.rlv && this.rlv.scrollToIndex(newIndex, true);\r\n  }\r\n\r\n  // Shift dates when end of list is reached.\r\n  shiftMonthsForward = currentMonth => {\r\n    this.shiftMonths(currentMonth, this.state.numMonths / 3);\r\n  }\r\n\r\n  // Shift dates when beginning of list is reached.\r\n  shiftMonthsBackward = currentMonth => {\r\n    this.shiftMonths(currentMonth, this.state.numMonths * 2/3);\r\n  }\r\n\r\n  // Go to specified month & year.\r\n  goToMonthYear = ({month, year}) => {\r\n    // Go to existing month if possible\r\n    const { data, numMonths } = this.state;\r\n    const monthYear = moment({month, year, hour: 12});\r\n    for (let i = 0; i < numMonths; i++) {\r\n      if (data[i].isSame(monthYear, 'month')) {\r\n        this.rlv && this.rlv.scrollToIndex(i, false);\r\n        return;\r\n      }\r\n    }\r\n    // Create new months\r\n    this.shiftMonths(monthYear, numMonths / 2);\r\n  }\r\n\r\n  shiftMonths = (currentMonth, offset) => {\r\n    const prevVisMonth = currentMonth.clone();\r\n    const newStartMonth = prevVisMonth.clone().subtract(Math.floor(offset), 'months');\r\n    this.updateMonths(prevVisMonth, newStartMonth);\r\n  }\r\n\r\n  updateMonths = (prevVisMonth, newStartMonth) => {\r\n    if (this.shifting) {\r\n      return;\r\n    }\r\n    const {\r\n      minDate,\r\n      maxDate,\r\n      restrictMonthNavigation,\r\n    } = this.props;\r\n    const data = [];\r\n    let _newStartMonth = newStartMonth;\r\n    if (minDate && restrictMonthNavigation && newStartMonth.isBefore(minDate, 'month')) {\r\n      _newStartMonth = moment(minDate);\r\n    }\r\n    for (let i = 0; i < this.state.numMonths; i++) {\r\n      let date = _newStartMonth.clone().add(i, 'months');\r\n      if (maxDate && restrictMonthNavigation && date.isAfter(maxDate, 'month')) {\r\n        break;\r\n      }\r\n      data.push(date);\r\n    }\r\n    // Prevent reducing range when the minDate - maxDate range is small.\r\n    if (data.length < this.props.maxSimultaneousMonths) {\r\n      return;\r\n    }\r\n\r\n    // Scroll to previous date\r\n    for (let i = 0; i < data.length; i++) {\r\n      if (data[i].isSame(prevVisMonth, 'month')) {\r\n        this.shifting = true;\r\n        this.rlv && this.rlv.scrollToIndex(i, false);\r\n        // RecyclerListView sometimes returns position to old index after\r\n        // moving to the new one. Set position again after delay.\r\n        setTimeout(() => {\r\n          this.rlv && this.rlv.scrollToIndex(i, false);\r\n          this.shifting = false; // debounce\r\n        }, 800);\r\n        break;\r\n      }\r\n    }\r\n    this.setState({\r\n      data,\r\n      dataProvider: this.dataProvider.cloneWithRows(data),\r\n    });\r\n  }\r\n\r\n  // Track which dates are visible.\r\n  onVisibleIndicesChanged = (all, now) => {\r\n    const {\r\n      data,\r\n      numMonths,\r\n      currentMonth: _currentMonth,\r\n    } = this.state;\r\n\r\n    const {\r\n      updateMonthYear,\r\n      onMonthChange,\r\n    } = this.props;\r\n\r\n    // \"now\" contains the inflight indices, whereas \"all\" reflects indices\r\n    // after scrolling has settled. Prioritize \"now\" for faster header updates.\r\n    const currentIndex = now[0] || all[0];\r\n    const currentMonth = data[currentIndex]; // a Moment date\r\n\r\n    // Fire month/year update on month changes.  This is\r\n    // necessary for the header and onMonthChange updates.\r\n    if (!_currentMonth || !_currentMonth.isSame(currentMonth, 'month')) {\r\n      const currMonth = currentMonth && currentMonth.clone();\r\n      onMonthChange && onMonthChange(currMonth);\r\n    }\r\n\r\n    updateMonthYear && updateMonthYear(currentMonth, true);\r\n\r\n    if (currentIndex === 0) {\r\n      this.shiftMonthsBackward(currentMonth);\r\n    } else if (currentIndex > numMonths - 3) {\r\n      this.shiftMonthsForward(currentMonth);\r\n    }\r\n    this.setState({\r\n      currentMonth,\r\n      currentIndex,\r\n    });\r\n  }\r\n\r\n  onLayout = event => {\r\n    const containerWidth = event.nativeEvent.layout.width;\r\n    this.setState({\r\n      numVisibleItems: Math.floor(containerWidth / this.state.itemWidth),\r\n      ...this.updateLayout(this.props.renderMonthParams.styles),\r\n    });\r\n  }\r\n\r\n  rowRenderer = (type, rowMonth, i, extState) => {\r\n    const { updateMonthYear, renderMonth } = this.props;\r\n    const { currentMonth: month, currentYear: year } = updateMonthYear(rowMonth);\r\n    return renderMonth && renderMonth({...extState, month, year});\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      data,\r\n      numMonths,\r\n      itemHeight: height,\r\n      itemWidth: width,\r\n      layoutProvider,\r\n      dataProvider,\r\n    } = this.state;\r\n    if (!data || numMonths === 0 || !height) {\r\n      return null;\r\n    }\r\n    return (\r\n      <View style={{ width, height }} onLayout={this.onLayout}>\r\n        <RecyclerListView\r\n          ref={rlv => this.rlv = rlv}\r\n          layoutProvider={layoutProvider}\r\n          dataProvider={dataProvider}\r\n          rowRenderer={this.rowRenderer}\r\n          extendedState={this.props.renderMonthParams}\r\n          initialRenderIndex={this.props.initialRenderIndex}\r\n          onVisibleIndicesChanged={this.onVisibleIndicesChanged}\r\n          isHorizontal={this.props.horizontal}\r\n          scrollViewProps={{\r\n            showsHorizontalScrollIndicator: false,\r\n            snapToInterval: this.props.horizontal ? width : height,\r\n          }}\r\n        />\r\n      </View>\r\n    );\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}